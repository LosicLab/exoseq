
// Variables and defaults
params.name = false
params.help = false
params.reads = false
params.genome = 'GRCh38'
params.singleEnd = false
params.run_id = false
params.saveReference = true
params.exome = true
params.kitfiles = 'agilent_v5'
params.sampleID = 'sampleID'
params.multiLane = true
params.aligner = "bwa"
params.refDir="/sc/orga/projects/losicb01a/common_folder/reference/"

// Output configuration
params.outdir = "./${params.sampleID}"
params.saveAlignedIntermediates = false
params.saveIntermediateVariants = false

// Kit options
params.bait = params.refs[ params.genome ] ? params.refs[ params.genome ].bait ?: false : false
params.target = params.refs[ params.genome ] ? params.refs[ params.genome ].target ?: false : false
params.target_bed = params.refs[ params.genome ] ? params.refs[ params.genome ].target_bed ?: false : false

// Reference Genome & Annotations
params.gfasta = params.refs[ params.genome ] ? params.refs[ params.genome ].gfasta ?: false : false
params.bwa_index = params.refs[ params.genome ] ? params.refs[ params.genome ].bwa_index ?: false : false
params.dbsnp = params.refs[ params.genome ] ? params.refs[ params.genome ].dbsnp ?: false : false
params.thousandg = params.refs[ params.genome ] ? params.refs[ params.genome ].thousandg ?: false : false
params.mills = params.refs[ params.genome ] ? params.refs[ params.genome ].mills ?: false : false
params.omni = params.refs[ params.genome ] ? params.refs[ params.genome ].omni ?: false : false
params.hapmap = params.refs[ params.genome ] ? params.refs[ params.genome ].hapmap ?: false : false
params.snpeff = params.refs[ params.genome ] ? params.refs[ params.genome ].snpeff ?: false : false
params.vep_cache = params.refs[ params.genome ] ? params.refs[ params.genome ].vep_cache ?: false : false
params.vep_fasta = params.refs[ params.genome ] ? params.refs[ params.genome ].vep_fasta ?: false : false
params.bed12 = params.refs[ params.genome ] ? params.refs[ params.genome ].bed12 ?: false : false

// Clipping options
params.notrim = false
params.saveTrimmed = false
params.clip_r1 = 0
params.clip_r2 = 0
params.three_prime_clip_r1 = 0
params.three_prime_clip_r2 = 0

process.module = ['picard/2.7.1', 'trim_galore/0.4.5', 'R', 'fastqc', 'samtools', 'bwa/0.7.15', 'gatk/4.0.1.2']
process.errorStrategy = { task.exitStatus == 143 ? 'retry' : 'finish' }
process.maxRetries = 5
process.maxErrors = '-1'

process.cpus = {2 * task.attempt}
process.memory = { 16.GB * task.attempt }
process.time = { 2.h * task.attempt }

env.PICARD= '$PICARD'