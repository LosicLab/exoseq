/*
MSSM Minerva config file for nfcore/ExoSeq pipeline
Contains paths (Losic-Group Specific) for meta files, genomes and
configurations for executors i.e. LSF

FOR RUNNING ON INTERACTIVE NODE!!
*/


process {
    executor = 'local'
    cpus = {2 * task.attempt}
    memory = { 16.GB * task.attempt }
    time = { 2.h * task.attempt }

    errorStrategy = { task.exitStatus == 143 ? 'retry' : 'finish' }
    maxRetries = 5
    maxErrors = '-1'
    module = ['picard/2.7.1', 'trimmomatic/0.36', 'R', 'fastqc', 'samtools', 'bwa/0.7.15', 'gatk/4.0.1.2']

    // step-specific resource allocations

    $fastqc {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 6.h * task.attempt }
    }

    $trimmomatic {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 6.h * task.attempt }
    }

    $bwamem {
        cpus = { 32 * task.attempt }
        memory = { 64.GB * task.attempt }
        time = { 10.h * task.attempt }
    }

    $markDuplicates {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 10.h * task.attempt }
    }

    $recalibrateBam {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 10.h * task.attempt }
    }

    $applyBQSR {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 10.h * task.attempt }
    }
    
    $collectMultiMetrics {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 10.h * task.attempt }
    }

    $variantCall {
        cpus = { 16 * task.attempt }
        memory = { 32.GB * task.attempt }
        time = { 16.h * task.attempt }
    }

}

env {
PICARD= '$PICARD'
TRIMMOMATIC='$TRIMMOMATIC_JAR'
}